<template name="appInstances">
	<h2>App Instances</h2>
	<button class="btn btn-primary newAppInstance">Launch New Instance</button>
	<button class="btn btn-danger rebuild-all">Rebuild All Instances</button>
	<form id="search-form" class="form-inline" role="form">
	  <div class="form-group">
	    <label class="sr-only" for="searchTerms">Search</label>
	    <input type="text" class="form-control" id="searchTerms" placeholder="Search" value="{{searchTerms}}">
	  </div>
	  <button type="submit" class="btn btn-primary">Search</button>
	</form>
	{{#with searchTerms}}
	<div class="searchFilterInfo"><span>Showing results for "{{this}}"</span><button class="btn-link clearSearch">Clear Search Filter</button></div>
	{{/with}}
	{{> DataTable
    	id="appInstancesTable"
        columns=this.columns
        subscription="appInstancesTable"
        query=appInstancesTableQuery
        options=this.options
        styles="table table-bordered table-striped"
    }}
</template>

<template name="createAppInstance">
	<ol class="breadcrumb">
		<li><a href="{{pathFor 'apps'}}">App Instances</a></li>
		<li class="active">Create</li>
	</ol>
	<h2>Launch a New Instance</h2>
	{{#autoForm schema=Schemas.LaunchInstance id="launchAppInstanceForm" role="form"}}
	{{> afQuickField name="dockerImage" options=dockerImageOptions firstOption="(Select a Docker Image)"}}
	{{> afQuickField name="mongoUrl"}}
	{{> afQuickField name="rootUrl"}}
	{{> afQuickField name="hostname"}}
	{{> afQuickField name="env"}}
	<button type="submit" class="btn btn-primary">Launch</button>
	{{/autoForm}}
</template>

<template name="appInstanceDetails">
	<ol class="breadcrumb">
		<li><a href="{{pathFor 'apps'}}">App Instances</a></li>
		<li class="active">{{_id}}</li>
	</ol>
	<table class="table">
		<tbody>
			<tr>
				<th>Instance ID</th>
				<td>{{_id}}</td>
			</tr>
			<tr>
				<th>Container ID</th>
				<td>{{#with containerId}}{{this}}{{else}}DEACTIVATED{{/with}}</td>
			</tr>
			<tr>
				<th>Container Process ID</th>
				<td>{{#with container.pid}}{{this}}{{else}}DEACTIVATED{{/with}}</td>
			</tr>
			<tr>
				<th>Image</th>
				<td>{{image}}</td>
			</tr>
			<tr>
				<th>Port</th>
				<td>{{#with port}}{{this}}{{else}}DEACTIVATED{{/with}}</td>
			</tr>
			<tr>
				<th>Available At</th>
				<td>
					{{#unless hosts}}
					{{#unless hostnames}}
					NOWHERE
					{{/unless}}
					{{/unless}}
					{{#unless containerId}}
					NOWHERE
					{{else}}
					{{#each hosts}}
					<div>
						<a href="http://{{this.privateHost}}:{{../port}}" target="_blank">{{this.privateHost}}:{{../port}}</a>
					</div>
					{{/each}}
					{{#each hostnames}}
					<div>
						<a href="http://{{this}}" target="_blank">{{this}}</a>
					</div>
					{{/each}}
					{{/unless}}
				</td>
			</tr>
			<tr>
				<th>Environment Variables</th>
				<td>
				<div><strong>Defined:</strong></div>
				{{#each envAsArray}}
				  <div>{{this}}</div>
				{{/each}}
				{{#with actualEnv}}
				<div><strong>Actual:</strong></div>
				{{#each this}}
				  <div>{{this}}</div>
				{{/each}}
				{{/with}}
				</td>
			</tr>
			<tr>
				<th>Status</th>
				<td>
				{{#if containerId}}
				  {{status}}
				{{else}}
				  DEACTIVATED
				{{/if}}
				</td>
			</tr>
			<tr>
				<th>Created At</th>
				<td>{{createdAtLong}}</td>
			</tr>
		</tbody>
	</table>
</template>